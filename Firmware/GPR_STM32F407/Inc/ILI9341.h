// Pins
#define LCD_BL 1	// PB1 - backlight

// Macro
#define swap(a1, a2) {\
	temp = a1;\
	a1 = a2;\
	a2 = temp;\
}

// Prototypes
void ili9341_init_mcu(void);
void ili9341_init(int hor, int ver);
void ili9341_set_pixel(short x0, short y0, short rgb565);
void ili9341_orientation(char orien);
void ili9341_set_area(short x0, short x1, short y0, short y1);
void ili9341_set_value(short* src, int len);
void ili9341_dma_wait();
void ili9341_dma_send(short *data, int len);

// ILI9341 definitions
// Commands
#define ILI9341_NOP 0x00
#define ILI9341_RST 0x01
#define ILI9341_READ_ID 0x04
#define ILI9341_READ_STS 0x09
#define ILI9341_READ_POWER_MODE 0x0A
#define ILI9341_READ_MADCTL 0x0B
#define ILI9341_READ_PIXEL_FORMAT 0x0C
#define ILI9341_READ_IMAGE_FORMAT 0x0D
#define ILI9341_READ_SIGNAL_MODE 0x0E
#define ILI9341_READ_SELF_DIAGNOSTIC 0x0F
#define ILI9341_ENTER_SLEEP_MODE 0x10
#define ILI9341_SLEEP_OUT 0x11
#define ILI9341_PARTIAL_MODE_ON 0x12
#define ILI9341_NORMAL_MODE_ON 0x13
#define ILI9341_DISPLAY_INVERSION_OFF 0x20
#define ILI9341_DISPLAY_INVERSION_ON 0x21
#define ILI9341_GAMMA_SET 0x26
#define ILI9341_DISPLAY_OFF 0x28
#define ILI9341_DISPLAY_ON 0x29
#define ILI9341_COLUMN_ADDRESS_SET 0x2A
#define ILI9341_PAGE_ADDRESS_SET 0x2B
#define ILI9341_MEMORY_WRITE 0x2C
#define ILI9341_COLOR_SET 0x2D
#define ILI9341_MEMORY_READ 0x2E
#define ILI9341_PARTIAL_AREA 0x30
#define ILI9341_VERTICAL_SCROLLING_DEFINITION 0x33
#define ILI9341_TEARING_OFF 0x34
#define ILI9341_TEARING_ON 0x35
#define ILI9341_MEMORY_ACCESS_CONTROL 0x36
#define ILI9341_VERTICAL_SCROLLING_START_ADDRESS 0x37
#define ILI9341_IDLE_OFF 0x38
#define ILI9341_IDLE_ON 0x39
#define ILI9341_PIXEL_FORMAT_SET 0x3A
#define ILI9341_WRITE_MEMORY_CONTINUE 0x3C
#define ILI9341_READ_MEMORY_CONTINUE 0x3E
#define ILI9341_SET_TEAR_SCANLINE 0x44
#define ILI9341_GET_SCANLINE 0x45
#define ILI9341_WRITE_BRIGHTNESS 0x51
#define ILI9341_READ_BRIGHTNESS 0x52
#define ILI9341_WRITE_CTRL 0x53
#define ILI9341_READ_CTRL 0x54
#define ILI9341_WRITE_CONTENT_ADAPTIVE_BRIGHTNESS_CONTROL 0x55
#define ILI9341_READ_CONTENT_ADAPTIVE_BRIGHTNESS_CONTROL 0x56
#define ILI9341_WRITE_CABC_MINIMUM_BRIGHTNESS 0x5E
#define ILI9341_READ_CABC_MINIMUM_BRIGHTNESS 0x5F
#define ILI9341_READ_ID1 0xDA
#define ILI9341_READ_ID2 0xDB
#define ILI9341_READ_ID3 0xDC

// Extended commands
#define ILI9341_RGB_INTERFACE_SIGNAL_CONTROL 0xB0
#define ILI9341_FRAME_CONTROL_NORMAL 0xB1
#define ILI9341_FRAME_CONTROL_IDLE 0xB2
#define ILI9341_FRAME_CONTROL_PARTIAL 0xB3
#define ILI9341_INVERSION_CONTROL 0xB4
#define ILI9341_BLANKING_PORCH_CONTROL 0xB5
#define ILI9341_FUNCTION_CONTROL 0xB6
#define ILI9341_ENTRY_MODE_SET 0xB7
#define ILI9341_BACKLIGHT_CONTROL1 0xB8
#define ILI9341_BACKLIGHT_CONTROL2 0xB9
#define ILI9341_BACKLIGHT_CONTROL3 0xBA
#define ILI9341_BACKLIGHT_CONTROL4 0xBB
#define ILI9341_BACKLIGHT_CONTROL5 0xBC
#define ILI9341_BACKLIGHT_CONTROL6 0xBD
#define ILI9341_BACKLIGHT_CONTROL7 0xBE
#define ILI9341_BACKLIGHT_CONTROL8 0xBF
#define ILI9341_POWER_CONTROL1 0xC0
#define ILI9341_POWER_CONTROL2 0xC1
#define ILI9341_VCOM_CONTROL1 0xC5
#define ILI9341_VCOM_CONTROL2 0xC7
#define ILI9341_NV_MEMORY_WRITE 0xD0
#define ILI9341_NV_MEMORY_PROTECTION_KEY 0xD1
#define ILI9341_NV_MEMORY_STATUS_READ 0xD2
#define ILI9341_READ_ID4 0xD3
#define ILI9341_POSITIVE_GAMMA_CORRECTION 0xE0
#define ILI9341_NEGATIVE_GAMMA_CORRECTION 0xE1
#define ILI9341_DIGITAL_GAMMA_CONTROL1 0xE2
#define ILI9341_DIGITAL_GAMMA_CONTROL2 0xE3
#define ILI9341_INTERFACE_CONTROL 0xF6
#define ILI9341_POWER_CONTROLA 0xCB
#define ILI9341_POWER_CONTROLB 0xCF
#define ILI9341_DRIVER_TIMING_CONTROLA 0xE8
#define ILI9341_DRIVER_TIMING_CONTROLAE 0xE9
#define ILI9341_DRIVER_TIMING_CONTROLB 0xEA
#define ILI9341_POWER_ON_SEQUENCE_CONTROL 0xED
#define ILI9341_ENABLE_3G 0xF2
#define ILI9341_PUMP_RATIO_CONTROL 0xF7
